import React from "react";
import { motion, AnimatePresence } from "framer-motion";
import { X, TrendingUp, TrendingDown, Minus } from "lucide-react";
import Button from "./Button";

interface StatsModalProps {
  isOpen: boolean;
  onClose: () => void;
  statType: string;
  statValue: string;
  stockData: any;
}

const StatsModal: React.FC<StatsModalProps> = ({
  isOpen,
  onClose,
  statType,
  statValue,
  stockData,
}) => {
  // Tamil explanations for each stat type
  const getStatExplanation = (type: string, value: string, data: any) => {
    const explanations: Record<string, any> = {
      "Market Cap": {
        title: "роЪроирпНродрпИ роорпВро▓родройроорпН (Market Capitalization)",
        definition:
          "роТро░рпБ роиро┐ро▒рпБро╡ройродрпНродро┐ройрпН роорпКродрпНрод роЪроирпНродрпИ роородро┐рокрпНрокрпБ. роЗродрпБ роиро┐ро▒рпБро╡ройродрпНродро┐ройрпН роорпКродрпНрод рокроЩрпНроХрпБроХро│ро┐ройрпН роОрогрпНрогро┐роХрпНроХрпИропрпИ родро▒рпНрокрпЛродрпИроп рокроЩрпНроХрпБ ро╡ро┐ро▓рпИропрпБроЯройрпН рокрпЖро░рпБроХрпНроХро┐ роХрогроХрпНроХро┐роЯрокрпНрокроЯрпБроХро┐ро▒родрпБ.",
        currentState: `родро▒рпНрокрпЛродрпИроп роЪроирпНродрпИ роорпВро▓родройроорпН: ${value}`,
        analysis: value.includes("T")
          ? "роЗродрпБ роТро░рпБ рокрпЖро░ро┐роп роиро┐ро▒рпБро╡ройроорпН (Large Cap) роЖроХрпБроорпН. рокрпКродрпБро╡ро╛роХ роиро┐ро▓рпИропро╛рой рооро▒рпНро▒рпБроорпН роироорпНрокроХрооро╛рой роорпБродро▓рпАроЯро╛роХ роХро░рпБродрокрпНрокроЯрпБроХро┐ро▒родрпБ."
          : value.includes("B") && parseFloat(value.replace(/[тВ╣B,]/g, "")) > 100
          ? "роЗродрпБ роТро░рпБ роироЯрпБродрпНродро░ роиро┐ро▒рпБро╡ройроорпН (Mid Cap) роЖроХрпБроорпН. роиро▓рпНро▓ ро╡ро│ро░рпНроЪрпНроЪро┐ роЪро╛родрпНродро┐ропроЩрпНроХро│рпБроЯройрпН роЗро░рпБроХрпНроХро▓ро╛роорпН."
          : "роЗродрпБ роТро░рпБ роЪро┐ро▒ро┐роп роиро┐ро▒рпБро╡ройроорпН (Small Cap) роЖроХрпБроорпН. роЕродро┐роХ ро░ро┐ро╕рпНроХрпН рооро▒рпНро▒рпБроорпН роЕродро┐роХ ро░ро┐роЯрпНроЯро░рпНройрпН роЪро╛родрпНродро┐ропроорпН роЙро│рпНро│родрпБ.",
        inference:
          "роЪроирпНродрпИ роорпВро▓родройроорпН роЕродро┐роХрооро╛роХ роЗро░рпБроирпНродро╛ро▓рпН, роиро┐ро▒рпБро╡ройроорпН роиро┐ро▓рпИропро╛ройродро╛роХро╡рпБроорпН, роХрпБро▒рпИро╡ро╛роХ роЗро░рпБроирпНродро╛ро▓рпН ро╡ро│ро░рпНроЪрпНроЪро┐ роЪро╛родрпНродро┐ропроорпН роЕродро┐роХрооро╛роХро╡рпБроорпН роЗро░рпБроХрпНроХро▓ро╛роорпН.",
        tips: "тАв рокрпЖро░ро┐роп роиро┐ро▒рпБро╡ройроЩрпНроХро│рпН рокро╛родрпБроХро╛рокрпНрокро╛рой роорпБродро▓рпАроЯрпБ\nтАв роЪро┐ро▒ро┐роп роиро┐ро▒рпБро╡ройроЩрпНроХро│рпН роЕродро┐роХ ро╡ро│ро░рпНроЪрпНроЪро┐ роЪро╛родрпНродро┐ропроорпН\nтАв роироЯрпБродрпНродро░ роиро┐ро▒рпБро╡ройроЩрпНроХро│рпН роЪроороиро┐ро▓рпИропро╛рой родрпЗро░рпНро╡рпБ",
      },
      "Current Price": {
        title: "родро▒рпНрокрпЛродрпИроп ро╡ро┐ро▓рпИ (Current Market Price)",
        definition:
          "рокроЩрпНроХрпБроЪрпНроЪроирпНродрпИропро┐ро▓рпН роЗроирпНрод роирпЗро░родрпНродро┐ро▓рпН роТро░рпБ рокроЩрпНроХро┐ройрпН ро╡ро┐ро▓рпИ. роЗродрпБ ро╡ро╛роЩрпНроХрпБрокро╡ро░рпНроХро│рпН рооро▒рпНро▒рпБроорпН ро╡ро┐ро▒рпНрокро╡ро░рпНроХро│ро┐ройрпН родрпЗро╡рпИ рооро▒рпНро▒рпБроорпН ро╡ро┐роиро┐ропрпЛроХродрпНродро┐ройрпН роЕроЯро┐рокрпНрокроЯрпИропро┐ро▓рпН родрпАро░рпНрооро╛ройро┐роХрпНроХрокрпНрокроЯрпБроХро┐ро▒родрпБ.",
        currentState: `родро▒рпНрокрпЛродрпИроп рокроЩрпНроХрпБ ро╡ро┐ро▓рпИ: ${value}`,
        analysis:
          "ро╡ро┐ро▓рпИ родро┐ройроЪро░ро┐ ро╡ро░рпНродрпНродроХродрпНродро┐ройрпН роЕроЯро┐рокрпНрокроЯрпИропро┐ро▓рпН рооро╛ро▒рпБроХро┐ро▒родрпБ. роиро┐ро▒рпБро╡ройродрпНродро┐ройрпН роЪрпЖропро▓рпНродро┐ро▒ройрпН рооро▒рпНро▒рпБроорпН роЪроирпНродрпИ роиро┐ро▓ро╡ро░родрпНродрпИ рокро┐ро░родро┐рокро▓ро┐роХрпНроХро┐ро▒родрпБ.",
        inference:
          "ро╡ро┐ро▓рпИ роЕродро┐роХро░ро┐рокрпНрокрпБ роиро▓рпНро▓ роЪрпЖропрпНродро┐роХро│рпИропрпБроорпН, роХрпБро▒рпИро╡рпБ роОродро┐ро░рпНрооро▒рпИ роЪрпЖропрпНродро┐роХро│рпИропрпБроорпН роХрпБро▒ро┐роХрпНроХро▓ро╛роорпН.",
        tips: "тАв родро┐ройроЪро░ро┐ ро╡ро┐ро▓рпИ рооро╛ро▒рпНро▒роЩрпНроХро│рпИ роХро╡ройро┐родрпНродрпБ ро╡ро╛ро░рпБроЩрпНроХро│рпН\nтАв роирпАрогрпНроЯ роХро╛ро▓ рокрпЛроХрпНроХрпБроХро│рпИ роХро╡ройро┐роХрпНроХро╡рпБроорпН\nтАв роЪрпЖропрпНродро┐роХро│рпН рооро▒рпНро▒рпБроорпН роЕро▒ро┐ро╡ро┐рокрпНрокрпБроХро│ро┐ройрпН родро╛роХрпНроХроорпН",
      },
      "High / Low": {
        title: "роЙропро░рпНроирпНрод / роХрпБро▒рпИроирпНрод ро╡ро┐ро▓рпИ (52-Week High/Low)",
        definition:
          "роХроЯроирпНрод 52 ро╡ро╛ро░роЩрпНроХро│ро┐ро▓рпН (роТро░рпБ ро╡ро░рпБроЯроорпН) роЗроирпНрод рокроЩрпНроХрпБ роОроЯрпНроЯро┐роп рооро┐роХ роЙропро░рпНроирпНрод рооро▒рпНро▒рпБроорпН рооро┐роХ роХрпБро▒рпИроирпНрод ро╡ро┐ро▓рпИроХро│рпН.",
        currentState: `52 ро╡ро╛ро░ роЗроЯрпИро╡рпЖро│ро┐: ${value}`,
        analysis: data?.currentPrice
          ? `родро▒рпНрокрпЛродрпИроп ро╡ро┐ро▓рпИ тВ╣${data.currentPrice} роЗроирпНрод роЗроЯрпИро╡рпЖро│ро┐ропро┐ро▓рпН ${
              data.currentPrice >
              (data.currentPrice * 1.15 + data.currentPrice * 0.85) / 2
                ? "роорпЗро▓рпН рокроХрпБродро┐ропро┐ро▓рпН"
                : "роХрпАро┤рпН рокроХрпБродро┐ропро┐ро▓рпН"
            } роЙро│рпНро│родрпБ.`
          : "ро╡ро┐ро▓рпИ роЗроЯрпИро╡рпЖро│ро┐ропро┐ро▓рпН роиро┐ро▒рпБро╡ройродрпНродро┐ройрпН роЪрпЖропро▓рпНродро┐ро▒ройрпИ роХро╛роЯрпНроЯрпБроХро┐ро▒родрпБ.",
        inference:
          "роЙропро░рпНроирпНрод ро╡ро┐ро▓рпИроХрпНроХрпБ роЕро░рпБроХро┐ро▓рпН роЗро░рпБроирпНродро╛ро▓рпН ро╡ро▓рпБро╡ро╛рой роЪрпЖропро▓рпНродро┐ро▒ройрпН, роХрпБро▒рпИроирпНрод ро╡ро┐ро▓рпИроХрпНроХрпБ роЕро░рпБроХро┐ро▓рпН роЗро░рпБроирпНродро╛ро▓рпН роЕродро┐роХ ро╡ро╛роЩрпНроХрпБроорпН ро╡ро╛ропрпНрокрпНрокрпБ роЗро░рпБроХрпНроХро▓ро╛роорпН.",
        tips: "тАв 52-ро╡ро╛ро░ роЙропро░рпНроирпНрод ро╡ро┐ро▓рпИроХрпНроХрпБ роЕро░рпБроХро┐ро▓рпН ро╡ро╛роЩрпНроХрпБро╡родро┐ро▓рпН роОроЪрпНроЪро░ро┐роХрпНроХрпИ\nтАв роХрпБро▒рпИроирпНрод ро╡ро┐ро▓рпИроХрпНроХрпБ роЕро░рпБроХро┐ро▓рпН ро╡ро╛роЩрпНроХрпБроорпН ро╡ро╛ропрпНрокрпНрокрпБ\nтАв роЪро░ро╛роЪро░ро┐ ро╡ро┐ро▓рпИропро┐ро▓рпН роиро▓рпНро▓ роирпБро┤рпИро╡рпБ рокрпБро│рпНро│ро┐",
      },
      "Stock P/E": {
        title: "рокро┐/роИ ро╡ро┐роХро┐родроорпН (Price to Earnings Ratio)",
        definition:
          "рокроЩрпНроХрпБ ро╡ро┐ро▓рпИропрпИ роТро░рпБ рокроЩрпНроХрпБроХрпНроХро╛рой ро╡ро░рпБрооро╛ройродрпНродро╛ро▓рпН ро╡роХрпБродрпНродро╛ро▓рпН роХро┐роЯрпИроХрпНроХрпБроорпН ро╡ро┐роХро┐родроорпН. роЗродрпБ рокроЩрпНроХро┐ройрпН роородро┐рокрпНрокрпАроЯрпНроЯрпИ роХрпБро▒ро┐роХрпНроХро┐ро▒родрпБ.",
        currentState: `родро▒рпНрокрпЛродрпИроп P/E ро╡ро┐роХро┐родроорпН: ${value}`,
        analysis: (() => {
          const peValue = parseFloat(value);
          if (isNaN(peValue)) return "P/E ро╡ро┐роХро┐родроорпН роХро┐роЯрпИроХрпНроХро╡ро┐ро▓рпНро▓рпИ.";
          if (peValue < 15) return "роХрпБро▒рпИроирпНрод P/E - рооро▓ро┐ро╡ро╛рой роородро┐рокрпНрокрпАроЯрпБ";
          if (peValue < 25) return "роироЯрпБродрпНродро░ P/E - роиро┐ропро╛ропрооро╛рой роородро┐рокрпНрокрпАроЯрпБ";
          return "роЙропро░рпНроирпНрод P/E - роЕродро┐роХ роородро┐рокрпНрокрпАроЯрпБ роЕро▓рпНро▓родрпБ ро╡ро│ро░рпНроЪрпНроЪро┐ роОродро┐ро░рпНрокро╛ро░рпНрокрпНрокрпБ";
        })(),
        inference:
          "роХрпБро▒рпИроирпНрод P/E роиро▓рпНро▓ ро╡ро╛роЩрпНроХрпБроорпН ро╡ро╛ропрпНрокрпНрокро╛роХро╡рпБроорпН, роЙропро░рпНроирпНрод P/E роЕродро┐роХ ро╡ро│ро░рпНроЪрпНроЪро┐ роОродро┐ро░рпНрокро╛ро░рпНрокрпНрокро╛роХро╡рпБроорпН роЗро░рпБроХрпНроХро▓ро╛роорпН.",
        tips: "тАв P/E < 15: рооро▓ро┐ро╡ро╛рой роородро┐рокрпНрокрпАроЯрпБ\nтАв P/E 15-25: роиро┐ропро╛ропрооро╛рой роородро┐рокрпНрокрпАроЯрпБ\nтАв P/E > 25: роЕродро┐роХ роородро┐рокрпНрокрпАроЯрпБ\nтАв родрпКро┤ро┐ро▓рпНродрпБро▒рпИ роЪро░ро╛роЪро░ро┐ропрпБроЯройрпН роТрокрпНрокро┐роЯро╡рпБроорпН",
      },
      "Book Value": {
        title: "рокрпБродрпНродроХ роородро┐рокрпНрокрпБ (Book Value)",
        definition:
          "роиро┐ро▒рпБро╡ройродрпНродро┐ройрпН роорпКродрпНрод роЪрпКродрпНродрпБроХро│ро┐ро▓ро┐ро░рпБроирпНродрпБ роХроЯройрпНроХро│рпИ роХро┤ро┐родрпНродрпБ роорпАродроорпБро│рпНро│ роородро┐рокрпНрокрпИ роорпКродрпНрод рокроЩрпНроХрпБроХро│ро╛ро▓рпН ро╡роХрпБродрпНродро╛ро▓рпН роХро┐роЯрпИроХрпНроХрпБроорпН родрпКроХрпИ.",
        currentState: `роТро░рпБ рокроЩрпНроХрпБроХрпНроХро╛рой рокрпБродрпНродроХ роородро┐рокрпНрокрпБ: ${value}`,
        analysis: data?.currentPrice
          ? `роЪроирпНродрпИ ро╡ро┐ро▓рпИ ${
              data.currentPrice > parseFloat(value.replace(/[тВ╣,]/g, ""))
                ? "рокрпБродрпНродроХ роородро┐рокрпНрокрпИ ро╡ро┐роЯ роЕродро┐роХроорпН"
                : "рокрпБродрпНродроХ роородро┐рокрпНрокрпИ ро╡ро┐роЯ роХрпБро▒рпИро╡рпБ"
            }`
          : "рокрпБродрпНродроХ роородро┐рокрпНрокрпБ роиро┐ро▒рпБро╡ройродрпНродро┐ройрпН роЙрогрпНроорпИропро╛рой роЪрпКродрпНродрпБ роородро┐рокрпНрокрпИ роХрпБро▒ро┐роХрпНроХро┐ро▒родрпБ.",
        inference:
          "роЪроирпНродрпИ ро╡ро┐ро▓рпИ рокрпБродрпНродроХ роородро┐рокрпНрокрпИ ро╡ро┐роЯ роХрпБро▒рпИро╡ро╛роХ роЗро░рпБроирпНродро╛ро▓рпН роЕродрпБ роиро▓рпНро▓ ро╡ро╛роЩрпНроХрпБроорпН ро╡ро╛ропрпНрокрпНрокро╛роХ роЗро░рпБроХрпНроХро▓ро╛роорпН.",
        tips: "тАв P/B ро╡ро┐роХро┐родроорпН < 1: роХрпБро▒рпИроородро┐рокрпНрокрпАроЯрпБ\nтАв P/B ро╡ро┐роХро┐родроорпН 1-3: роиро┐ропро╛ропрооро╛рой роородро┐рокрпНрокрпАроЯрпБ\nтАв P/B ро╡ро┐роХро┐родроорпН > 3: роЕродро┐роХ роородро┐рокрпНрокрпАроЯрпБ\nтАв роЪрпКродрпНродрпБ роЕроЯро┐рокрпНрокроЯрпИропро┐ро▓ро╛рой роиро┐ро▒рпБро╡ройроЩрпНроХро│рпБроХрпНроХрпБ роорпБроХрпНроХро┐ропроорпН",
      },
      "Dividend Yield": {
        title: "роЯро┐ро╡ро┐роЯрпЖрогрпНроЯрпН роИро▓рпНроЯрпН (Dividend Yield)",
        definition:
          "роиро┐ро▒рпБро╡ройроорпН роЖрогрпНроЯрпБроХрпНроХрпБ ро╡ро┤роЩрпНроХрпБроорпН роЯро┐ро╡ро┐роЯрпЖрогрпНроЯрпИ родро▒рпНрокрпЛродрпИроп рокроЩрпНроХрпБ ро╡ро┐ро▓рпИропро╛ро▓рпН ро╡роХрпБродрпНродро╛ро▓рпН роХро┐роЯрпИроХрпНроХрпБроорпН роЪродро╡рпАродроорпН.",
        currentState: `ро╡ро░рпБроЯро╛роирпНродро┐ро░ роЯро┐ро╡ро┐роЯрпЖрогрпНроЯрпН роИро▓рпНроЯрпН: ${value}`,
        analysis: (() => {
          const yieldValue = parseFloat(value.replace("%", ""));
          if (isNaN(yieldValue)) return "роЯро┐ро╡ро┐роЯрпЖрогрпНроЯрпН родроХро╡ро▓рпН роХро┐роЯрпИроХрпНроХро╡ро┐ро▓рпНро▓рпИ.";
          if (yieldValue < 1) return "роХрпБро▒рпИроирпНрод роЯро┐ро╡ро┐роЯрпЖрогрпНроЯрпН - ро╡ро│ро░рпНроЪрпНроЪро┐ роХро╡ройроорпН";
          if (yieldValue < 3) return "роироЯрпБродрпНродро░ роЯро┐ро╡ро┐роЯрпЖрогрпНроЯрпН - роЪроороиро┐ро▓рпИропро╛рой роЕрогрпБроХрпБроорпБро▒рпИ";
          return "роЙропро░рпНроирпНрод роЯро┐ро╡ро┐роЯрпЖрогрпНроЯрпН - ро╡ро░рпБрооро╛рой роХро╡ройроорпН";
        })(),
        inference:
          "роЕродро┐роХ роЯро┐ро╡ро┐роЯрпЖрогрпНроЯрпН роИро▓рпНроЯрпН ро╡ро░рпБроЯро╛роирпНродро┐ро░ ро╡ро░рпБрооро╛ройродрпНродро┐ро▒рпНроХрпБ роиро▓рпНро▓родрпБ, роХрпБро▒рпИроирпНрод роИро▓рпНроЯрпН ро╡ро│ро░рпНроЪрпНроЪро┐ роХро╡ройродрпНродрпИ роХрпБро▒ро┐роХрпНроХро┐ро▒родрпБ.",
        tips: "тАв 0-1%: ро╡ро│ро░рпНроЪрпНроЪро┐ роиро┐ро▒рпБро╡ройроЩрпНроХро│рпН\nтАв 1-3%: роЪроороиро┐ро▓рпИропро╛рой роиро┐ро▒рпБро╡ройроЩрпНроХро│рпН\nтАв 3%+: ро╡ро░рпБрооро╛рой роХро╡ройроорпН\nтАв роиро┐ро▓рпИропро╛рой роЯро┐ро╡ро┐роЯрпЖрогрпНроЯрпН ро╡ро░ро▓ро╛ро▒рпБ роорпБроХрпНроХро┐ропроорпН",
      },
      ROCE: {
        title: "роорпБродро▓рпАроЯрпНроЯрпБ роорпВро▓родрой ро╡ро░рпБрооро╛ройроорпН (Return on Capital Employed)",
        definition:
          "роиро┐ро▒рпБро╡ройроорпН родройродрпБ роорпКродрпНрод роорпВро▓родройродрпНродро┐ро▓рпН роОро╡рпНро╡ро│ро╡рпБ родро┐ро▒роорпИропро╛роХ ро╡ро░рпБрооро╛ройроорпН роИроЯрпНроЯрпБроХро┐ро▒родрпБ роОройрпНрокродрпИ роХрпБро▒ро┐роХрпНроХрпБроорпН роЪродро╡рпАродроорпН.",
        currentState: `родро▒рпНрокрпЛродрпИроп ROCE: ${value}`,
        analysis: (() => {
          const roceValue = parseFloat(value.replace("%", ""));
          if (isNaN(roceValue)) return "ROCE родроХро╡ро▓рпН роХро┐роЯрпИроХрпНроХро╡ро┐ро▓рпНро▓рпИ.";
          if (roceValue < 10)
            return "роХрпБро▒рпИроирпНрод ROCE - роорпВро▓родрой рокропройрпНрокро╛роЯрпНроЯро┐ро▓рпН рокро▓ро╡рпАройроорпН";
          if (roceValue < 20) return "роиро▓рпНро▓ ROCE - родро┐ро▒роорпИропро╛рой роорпВро▓родрой рокропройрпНрокро╛роЯрпБ";
          return "рооро┐роХроЪрпНроЪро┐ро▒роирпНрод ROCE - рооро┐роХро╡рпБроорпН родро┐ро▒роорпИропро╛рой роиро┐ро▒рпБро╡ройроорпН";
        })(),
        inference:
          "роЕродро┐роХ ROCE роиро┐ро▒рпБро╡ройроорпН родройродрпБ роорпВро▓родройродрпНродрпИ родро┐ро▒роорпИропро╛роХ рокропройрпНрокроЯрпБродрпНродрпБро╡родрпИропрпБроорпН, ро▓ро╛рокроХро░рооро╛рой ро╡рогро┐роХродрпНродрпИропрпБроорпН роХрпБро▒ро┐роХрпНроХро┐ро▒родрпБ.",
        tips: "тАв ROCE > 15%: рооро┐роХроЪрпНроЪро┐ро▒роирпНрод\nтАв ROCE 10-15%: роиро▓рпНро▓родрпБ\nтАв ROCE < 10%: роорпЗроорпНрокро╛роЯрпБ родрпЗро╡рпИ\nтАв родрпКро┤ро┐ро▓рпНродрпБро▒рпИ роЪро░ро╛роЪро░ро┐ропрпБроЯройрпН роТрокрпНрокро┐роЯро╡рпБроорпН",
      },
      ROE: {
        title: "рокроЩрпНроХрпБродро╛ро░ро░рпН роорпВро▓родрой ро╡ро░рпБрооро╛ройроорпН (Return on Equity)",
        definition:
          "роиро┐ро▒рпБро╡ройроорпН рокроЩрпНроХрпБродро╛ро░ро░рпНроХро│ро┐ройрпН роорпВро▓родройродрпНродро┐ро▓рпН роОро╡рпНро╡ро│ро╡рпБ ро╡ро░рпБрооро╛ройроорпН роИроЯрпНроЯрпБроХро┐ро▒родрпБ роОройрпНрокродрпИ роХрпБро▒ро┐роХрпНроХрпБроорпН роЪродро╡рпАродроорпН.",
        currentState: `родро▒рпНрокрпЛродрпИроп ROE: ${value}`,
        analysis: (() => {
          const roeValue = parseFloat(value.replace("%", ""));
          if (isNaN(roeValue)) return "ROE родроХро╡ро▓рпН роХро┐роЯрпИроХрпНроХро╡ро┐ро▓рпНро▓рпИ.";
          if (roeValue < 10)
            return "роХрпБро▒рпИроирпНрод ROE - рокроЩрпНроХрпБродро╛ро░ро░рпН роорпВро▓родрой рокропройрпНрокро╛роЯрпНроЯро┐ро▓рпН рокро▓ро╡рпАройроорпН";
          if (roeValue < 20)
            return "роиро▓рпНро▓ ROE - рокроЩрпНроХрпБродро╛ро░ро░рпНроХро│рпБроХрпНроХрпБ роиро▓рпНро▓ ро╡ро░рпБрооро╛ройроорпН";
          return "рооро┐роХроЪрпНроЪро┐ро▒роирпНрод ROE - рооро┐роХро╡рпБроорпН ро▓ро╛рокроХро░рооро╛рой роиро┐ро▒рпБро╡ройроорпН";
        })(),
        inference:
          "роЕродро┐роХ ROE роиро┐ро▒рпБро╡ройроорпН рокроЩрпНроХрпБродро╛ро░ро░рпНроХро│ро┐ройрпН рокрогродрпНродрпИ родро┐ро▒роорпИропро╛роХ рокропройрпНрокроЯрпБродрпНродро┐ роЕродро┐роХ ро▓ро╛рокроорпН роИроЯрпНроЯрпБро╡родрпИ роХрпБро▒ро┐роХрпНроХро┐ро▒родрпБ.",
        tips: "тАв ROE > 15%: рооро┐роХроЪрпНроЪро┐ро▒роирпНрод\nтАв ROE 10-15%: роиро▓рпНро▓родрпБ\nтАв ROE < 10%: роХро╡ройроорпН родрпЗро╡рпИ\nтАв роирпАрогрпНроЯ роХро╛ро▓ ROE рокрпЛроХрпНроХрпБ роорпБроХрпНроХро┐ропроорпН",
      },
      Sector: {
        title: "родрпКро┤ро┐ро▓рпНродрпБро▒рпИ (Business Sector)",
        definition:
          "роиро┐ро▒рпБро╡ройроорпН роОроирпНрод родрпКро┤ро┐ро▓рпНродрпБро▒рпИропро┐ро▓рпН роЪрпЖропро▓рпНрокроЯрпБроХро┐ро▒родрпБ роОройрпНрокродрпИ роХрпБро▒ро┐роХрпНроХро┐ро▒родрпБ. роТро╡рпНро╡рпКро░рпБ родрпБро▒рпИропрпБроорпН ро╡рпЖро╡рпНро╡рпЗро▒рпБ ро╡ро│ро░рпНроЪрпНроЪро┐ роЪро╛родрпНродро┐ропроЩрпНроХро│рпИропрпБроорпН ро░ро┐ро╕рпНроХрпНроХрпБроХро│рпИропрпБроорпН роХрпКрогрпНроЯрпБро│рпНро│родрпБ.",
        currentState: `родрпКро┤ро┐ро▓рпНродрпБро▒рпИ: ${value}`,
        analysis: (() => {
          const sectorAnalysis: Record<string, string> = {
            Technology:
              "родрпКро┤ро┐ро▓рпНроирпБроЯрпНрокродрпН родрпБро▒рпИ - роЕродро┐роХ ро╡ро│ро░рпНроЪрпНроЪро┐ роЪро╛родрпНродро┐ропроорпН, роиро╡рпАройрооропрооро╛роХрпНроХро▓рпН роиройрпНроорпИ",
            Banking: "ро╡роЩрпНроХро┐родрпН родрпБро▒рпИ - рокрпКро░рпБро│ро╛родро╛ро░ ро╡ро│ро░рпНроЪрпНроЪро┐ропрпБроЯройрпН роЗрогрпИроирпНрод роЪрпЖропро▓рпНрокро╛роЯрпБ",
            Pharmaceuticals:
              "рооро░рпБроирпНродрпБродрпН родрпБро▒рпИ - роиро┐ро▓рпИропро╛рой родрпЗро╡рпИ, роЖро░ро╛ропрпНроЪрпНроЪро┐ роорпБродро▓рпАроЯрпБ роорпБроХрпНроХро┐ропроорпН",
            Energy: "роОро░ро┐роЪроХрпНродро┐родрпН родрпБро▒рпИ - рокрпКро░рпБроЯрпНроХро│ро┐ройрпН ро╡ро┐ро▓рпИ роПро▒рпНро▒ роЗро▒роХрпНроХроорпН рокро╛родро┐рокрпНрокрпБ",
            FMCG: "роирпБроХро░рпНро╡рпЛро░рпН рокрпКро░рпБроЯрпНроХро│рпН - роиро┐ро▓рпИропро╛рой родрпЗро╡рпИ, роороХрпНроХро│рпНродрпКроХрпИ ро╡ро│ро░рпНроЪрпНроЪро┐ роиройрпНроорпИ",
            Automobile: "ро╡ро╛роХройродрпН родрпБро▒рпИ - рокрпКро░рпБро│ро╛родро╛ро░ роЪрпБро┤ро▒рпНроЪро┐ роЪро╛ро░рпНроирпНрод родрпБро▒рпИ",
          };
          return (
            sectorAnalysis[value] ||
            "роЗроирпНрод родрпКро┤ро┐ро▓рпНродрпБро▒рпИропро┐ройрпН роЪро┐ро▒рокрпНрокрпБ рокрогрпНрокрпБроХро│рпИ роЖро░ро╛ропрпБроЩрпНроХро│рпН"
          );
        })(),
        inference:
          "родрпКро┤ро┐ро▓рпНродрпБро▒рпИ роЪрпЖропро▓рпНродро┐ро▒ройрпН роТроЯрпНроЯрпБроорпКродрпНрод рокрпКро░рпБро│ро╛родро╛ро░роорпН, роЕро░роЪрпБ роХрпКро│рпНроХрпИроХро│рпН рооро▒рпНро▒рпБроорпН роЙро▓роХро│ро╛ро╡ро┐роп рокрпЛроХрпНроХрпБроХро│ро╛ро▓рпН рокро╛родро┐роХрпНроХрокрпНрокроЯрпБроХро┐ро▒родрпБ.",
        tips: "тАв родрпБро▒рпИ ро╡ро│ро░рпНроЪрпНроЪро┐ рокрпЛроХрпНроХрпБроХро│рпИ роЖро░ро╛ропрпБроЩрпНроХро│рпН\nтАв роЕро░роЪрпБ роХрпКро│рпНроХрпИроХро│ро┐ройрпН родро╛роХрпНроХроорпН\nтАв роЙро▓роХро│ро╛ро╡ро┐роп рокрпЛроЯрпНроЯро┐ роиро┐ро▓ро╡ро░роорпН\nтАв родрпКро┤ро┐ро▓рпНроирпБроЯрпНрок рооро╛ро▒рпНро▒роЩрпНроХро│ро┐ройрпН рокро╛родро┐рокрпНрокрпБ",
      },
      "Face Value": {
        title: "роорпБроХ роородро┐рокрпНрокрпБ (Face Value)",
        definition:
          "рокроЩрпНроХрпБ роЪро╛ройрпНро▒ро┐родро┤ро┐ро▓рпН роЕроЪрпНроЪро┐роЯрокрпНрокроЯрпНроЯ роЕроЪро▓рпН роородро┐рокрпНрокрпБ. роЗродрпБ рокроЩрпНроХрпБ рокро┐ро░ро┐рокрпНрокрпБ рооро▒рпНро▒рпБроорпН роЯро┐ро╡ро┐роЯрпЖрогрпНроЯрпН роХрогроХрпНроХрпАроЯрпНроЯро┐ро▒рпНроХрпБ рокропройрпНрокроЯрпБроХро┐ро▒родрпБ.",
        currentState: `роорпБроХ роородро┐рокрпНрокрпБ: ${value}`,
        analysis:
          "роЗроирпНродро┐ропро╛ро╡ро┐ро▓рпН рокрпЖро░рпБроорпНрокро╛ро▓ро╛рой рокроЩрпНроХрпБроХро│ро┐ройрпН роорпБроХ роородро┐рокрпНрокрпБ тВ╣1, тВ╣2, тВ╣5 роЕро▓рпНро▓родрпБ тВ╣10 роЖроХ роЗро░рпБроХрпНроХрпБроорпН. роЗродрпБ роЪроирпНродрпИ ро╡ро┐ро▓рпИропрпИ рокро╛родро┐роХрпНроХро╛родрпБ.",
        inference:
          "роорпБроХ роородро┐рокрпНрокрпБ роорпБродро▓рпАроЯрпНроЯрпБ роорпБроЯро┐ро╡рпБроХро│ро┐ро▓рпН роирпЗро░роЯро┐ рокро╛родро┐рокрпНрокрпБ роЗро▓рпНро▓рпИ, роЖройро╛ро▓рпН роиро┐ро▒рпБро╡рой роХроЯрпНроЯроорпИрокрпНрокрпБ рооро▒рпНро▒рпБроорпН роЯро┐ро╡ро┐роЯрпЖрогрпНроЯрпН роХрогроХрпНроХрпАроЯрпНроЯро┐ро▓рпН рокропройрпНрокроЯрпБроХро┐ро▒родрпБ.",
        tips: "тАв роорпБроХ роородро┐рокрпНрокрпБ vs роЪроирпНродрпИ ро╡ро┐ро▓рпИ ро╡рпЗро▒рпБрокро╛роЯрпБ\nтАв рокроЩрпНроХрпБ рокро┐ро░ро┐рокрпНрокро┐ройрпН рокрпЛродрпБ роорпБроХрпНроХро┐ропроорпН\nтАв роЯро┐ро╡ро┐роЯрпЖрогрпНроЯрпН роХрогроХрпНроХрпАроЯрпНроЯро┐ро▓рпН рокропройрпНрокро╛роЯрпБ\nтАв роиро┐ро▒рпБро╡рой роХроЯрпНроЯроорпИрокрпНрокро┐ройрпН роТро░рпБ рокроХрпБродро┐",
      },
    };

    return (
      explanations[type] || {
        title: "родроХро╡ро▓рпН роХро┐роЯрпИроХрпНроХро╡ро┐ро▓рпНро▓рпИ",
        definition: "роЗроирпНрод роЕро│ро╡рпБро░рпБро╡ро┐ройрпН ро╡ро┐ро│роХрпНроХроорпН родро▒рпНрокрпЛродрпБ роХро┐роЯрпИроХрпНроХро╡ро┐ро▓рпНро▓рпИ.",
        currentState: `роородро┐рокрпНрокрпБ: ${value}`,
        analysis: "ро╡ро┐ро░ро┐ро╡ро╛рой рокроХрпБрокрпНрокро╛ропрпНро╡рпБ родро▒рпНрокрпЛродрпБ роХро┐роЯрпИроХрпНроХро╡ро┐ро▓рпНро▓рпИ.",
        inference: "роорпЗро▓рпБроорпН роЖро░ро╛ропрпНроЪрпНроЪро┐ родрпЗро╡рпИ.",
        tips: "роиро┐родро┐ роЖро▓рпЛроЪроХро░рпИ роЕрогрпБроХро╡рпБроорпН.",
      }
    );
  };

  const explanation = getStatExplanation(statType, statValue, stockData);

  return (
    <AnimatePresence>
      {isOpen && (
        <motion.div
          initial={{ opacity: 0 }}
          animate={{ opacity: 1 }}
          exit={{ opacity: 0 }}
          className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"
          onClick={onClose}
        >
          <motion.div
            initial={{ scale: 0.9, opacity: 0 }}
            animate={{ scale: 1, opacity: 1 }}
            exit={{ scale: 0.9, opacity: 0 }}
            className="bg-white rounded-2xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto"
            onClick={(e) => e.stopPropagation()}
          >
            {/* Header */}
            <div className="flex items-center justify-between p-6 border-b border-gray-200">
              <h2 className="text-xl font-bold text-gray-900">
                {explanation.title}
              </h2>
              <Button variant="outline" size="sm" onClick={onClose}>
                <X className="w-4 h-4" />
              </Button>
            </div>

            {/* Content */}
            <div className="p-6 space-y-6">
              {/* Definition */}
              <div>
                <h3 className="text-lg font-semibold text-gray-800 mb-2 flex items-center">
                  <div className="w-2 h-2 bg-blue-500 rounded-full mr-2"></div>
                  роЗродрпБ роОройрпНрой?
                </h3>
                <p className="text-gray-700 leading-relaxed">
                  {explanation.definition}
                </p>
              </div>

              {/* Current State */}
              <div className="bg-blue-50 rounded-lg p-4 border border-blue-200">
                <h3 className="text-lg font-semibold text-blue-800 mb-2 flex items-center">
                  <div className="w-2 h-2 bg-blue-600 rounded-full mr-2"></div>
                  родро▒рпНрокрпЛродрпИроп роиро┐ро▓ро╡ро░роорпН
                </h3>
                <p className="text-blue-700 font-medium">
                  {explanation.currentState}
                </p>
              </div>

              {/* Analysis */}
              <div className="bg-green-50 rounded-lg p-4 border border-green-200">
                <h3 className="text-lg font-semibold text-green-800 mb-2 flex items-center">
                  <div className="w-2 h-2 bg-green-600 rounded-full mr-2"></div>
                  рокроХрпБрокрпНрокро╛ропрпНро╡рпБ
                </h3>
                <p className="text-green-700">{explanation.analysis}</p>
              </div>

              {/* Inference */}
              <div className="bg-purple-50 rounded-lg p-4 border border-purple-200">
                <h3 className="text-lg font-semibold text-purple-800 mb-2 flex items-center">
                  <div className="w-2 h-2 bg-purple-600 rounded-full mr-2"></div>
                  роЗродро┐ро▓ро┐ро░рпБроирпНродрпБ роОройрпНрой рокрпБро░ро┐ропрпБроорпН?
                </h3>
                <p className="text-purple-700">{explanation.inference}</p>
              </div>

              {/* Tips */}
              <div className="bg-orange-50 rounded-lg p-4 border border-orange-200">
                <h3 className="text-lg font-semibold text-orange-800 mb-2 flex items-center">
                  <div className="w-2 h-2 bg-orange-600 rounded-full mr-2"></div>
                  роорпБроХрпНроХро┐роп роХрпБро▒ро┐рокрпНрокрпБроХро│рпН
                </h3>
                <pre className="text-orange-700 text-sm whitespace-pre-line font-sans">
                  {explanation.tips}
                </pre>
              </div>
            </div>

            {/* Footer */}
            <div className="p-6 border-t border-gray-200 bg-gray-50 rounded-b-2xl">
              <p className="text-xs text-gray-600 text-center">
                ЁЯТб роЗроирпНрод родроХро╡ро▓рпНроХро│рпН роХро▓рпНро╡ро┐ роирпЛроХрпНроХродрпНродро┐ро▒рпНроХро╛роХ роороЯрпНроЯрпБроорпЗ. роорпБродро▓рпАроЯрпНроЯрпБ
                роорпБроЯро┐ро╡рпБроХро│рпБроХрпНроХрпБ роиро┐родро┐ роЖро▓рпЛроЪроХро░рпИ роЕрогрпБроХро╡рпБроорпН.
              </p>
            </div>
          </motion.div>
        </motion.div>
      )}
    </AnimatePresence>
  );
};

export default StatsModal;
